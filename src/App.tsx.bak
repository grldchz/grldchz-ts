import * as React from 'react';
import Login from './components/Login';
import Posts from './components/Posts';
import useProfileService from './services/useProfileService'
interface AppProps {
  onLogin?: any
  onProfile?: any
}
interface AppState {
  profile: any;
}

class App extends React.Component<AppProps, AppState> {
  constructor(props: AppProps) {
    super(props);
    this.onLogin = this.onLogin.bind(this);
    this.onProfile = this.onProfile.bind(this);
    const service = useProfileService(this.onProfile);
    this.state = {
      profile: service
    };

  }  
  render() {
    
    return (
      <div className="App">
        <header className="header">
          <div className="container">
            <h1>GRLD CHZ </h1>
            <p className="slogan">
              Grilled Cheese of the Day
            </p>
          </div>
        </header>
        {this.state.profile.status}
        <div className="container">
          {this.state.profile.status == 'FAIL' && (
            <Login onLogin={this.onLogin} />
          )}         
          {this.state.profile && (
            <Posts />
          )}         
        </div>


      </div>
    );
  }
  onLogin(response: string){
    console.log("onLogin:", response);
    const service = useProfileService(this.onProfile);
    this.setState({ profile: service });
  }
  onProfile(response: string){
    console.log("onProfile:", response);
    this.setState({ profile: response });
  }
}

export default App;
